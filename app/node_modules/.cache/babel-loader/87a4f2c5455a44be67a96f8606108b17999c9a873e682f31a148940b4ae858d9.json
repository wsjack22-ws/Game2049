{"ast":null,"code":"import { concat } from \"uint8arrays/concat\";\nimport { toString } from \"uint8arrays/to-string\";\nimport { fromString } from \"uint8arrays/from-string\";\nimport { safeJsonParse, safeJsonStringify } from \"@walletconnect/safe-json\";\nimport { DATA_ENCODING, DID_DELIMITER, DID_METHOD, DID_PREFIX, JSON_ENCODING, JWT_DELIMITER, JWT_ENCODING, MULTICODEC_ED25519_BASE, MULTICODEC_ED25519_ENCODING, MULTICODEC_ED25519_HEADER, MULTICODEC_ED25519_LENGTH } from \"./constants\";\nexport function decodeJSON(str) {\n  return safeJsonParse(toString(fromString(str, JWT_ENCODING), JSON_ENCODING));\n}\nexport function encodeJSON(val) {\n  return toString(fromString(safeJsonStringify(val), JSON_ENCODING), JWT_ENCODING);\n}\nexport function encodeIss(publicKey) {\n  const header = fromString(MULTICODEC_ED25519_HEADER, MULTICODEC_ED25519_ENCODING);\n  const multicodec = MULTICODEC_ED25519_BASE + toString(concat([header, publicKey]), MULTICODEC_ED25519_ENCODING);\n  return [DID_PREFIX, DID_METHOD, multicodec].join(DID_DELIMITER);\n}\nexport function decodeIss(issuer) {\n  const [prefix, method, multicodec] = issuer.split(DID_DELIMITER);\n  if (prefix !== DID_PREFIX || method !== DID_METHOD) {\n    throw new Error(`Issuer must be a DID with method \"key\"`);\n  }\n  const base = multicodec.slice(0, 1);\n  if (base !== MULTICODEC_ED25519_BASE) {\n    throw new Error(`Issuer must be a key in mulicodec format`);\n  }\n  const bytes = fromString(multicodec.slice(1), MULTICODEC_ED25519_ENCODING);\n  const type = toString(bytes.slice(0, 2), MULTICODEC_ED25519_ENCODING);\n  if (type !== MULTICODEC_ED25519_HEADER) {\n    throw new Error(`Issuer must be a public key with type \"Ed25519\"`);\n  }\n  const publicKey = bytes.slice(2);\n  if (publicKey.length !== MULTICODEC_ED25519_LENGTH) {\n    throw new Error(`Issuer must be a public key with length 32 bytes`);\n  }\n  return publicKey;\n}\nexport function encodeSig(bytes) {\n  return toString(bytes, JWT_ENCODING);\n}\nexport function decodeSig(encoded) {\n  return fromString(encoded, JWT_ENCODING);\n}\nexport function encodeData(params) {\n  return fromString([encodeJSON(params.header), encodeJSON(params.payload)].join(JWT_DELIMITER), DATA_ENCODING);\n}\nexport function decodeData(data) {\n  const params = toString(data, DATA_ENCODING).split(JWT_DELIMITER);\n  const header = decodeJSON(params[0]);\n  const payload = decodeJSON(params[1]);\n  return {\n    header,\n    payload\n  };\n}\nexport function encodeJWT(params) {\n  return [encodeJSON(params.header), encodeJSON(params.payload), encodeSig(params.signature)].join(JWT_DELIMITER);\n}\nexport function decodeJWT(jwt) {\n  const params = jwt.split(JWT_DELIMITER);\n  const header = decodeJSON(params[0]);\n  const payload = decodeJSON(params[1]);\n  const signature = decodeSig(params[2]);\n  const data = fromString(params.slice(0, 2).join(JWT_DELIMITER), DATA_ENCODING);\n  return {\n    header,\n    payload,\n    signature,\n    data\n  };\n}","map":{"version":3,"names":["concat","toString","fromString","safeJsonParse","safeJsonStringify","DATA_ENCODING","DID_DELIMITER","DID_METHOD","DID_PREFIX","JSON_ENCODING","JWT_DELIMITER","JWT_ENCODING","MULTICODEC_ED25519_BASE","MULTICODEC_ED25519_ENCODING","MULTICODEC_ED25519_HEADER","MULTICODEC_ED25519_LENGTH","decodeJSON","str","encodeJSON","val","encodeIss","publicKey","header","multicodec","join","decodeIss","issuer","prefix","method","split","Error","base","slice","bytes","type","length","encodeSig","decodeSig","encoded","encodeData","params","payload","decodeData","data","encodeJWT","signature","decodeJWT","jwt"],"sources":["../../src/utils.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}