{"ast":null,"code":"import Bowser from 'bowser';\nimport loglevel from 'loglevel';\n\n/**\n * returns true if the given object is a promise\n */\nexport function isPromise(obj) {\n  if (obj && typeof obj.then === 'function') {\n    return true;\n  } else {\n    return false;\n  }\n}\nexport var PROMISE_RESOLVED_FALSE = Promise.resolve(false);\nexport var PROMISE_RESOLVED_TRUE = Promise.resolve(true);\nexport var PROMISE_RESOLVED_VOID = Promise.resolve();\nexport function sleep(time, resolveWith) {\n  if (!time) time = 0;\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      return res(resolveWith);\n    }, time);\n  });\n}\nexport function randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n\n/**\n * https://stackoverflow.com/a/8084248\n */\nexport function randomToken() {\n  return Math.random().toString(36).substring(2);\n}\nvar lastMs = 0;\nvar additional = 0;\n\n/**\n * returns the current time in micro-seconds,\n * WARNING: This is a pseudo-function\n * Performance.now is not reliable in webworkers, so we just make sure to never return the same time.\n * This is enough in browsers, and this function will not be used in nodejs.\n * The main reason for this hack is to ensure that BroadcastChannel behaves equal to production when it is used in fast-running unit tests.\n */\nexport function microSeconds() {\n  var ms = new Date().getTime();\n  if (ms === lastMs) {\n    additional++;\n    return ms * 1000 + additional;\n  } else {\n    lastMs = ms;\n    additional = 0;\n    return ms * 1000;\n  }\n}\nexport function are3PCSupported() {\n  if (typeof navigator === 'undefined') return false;\n  var browserInfo = Bowser.parse(navigator.userAgent);\n  log.info(JSON.stringify(browserInfo), 'current browser info');\n  var thirdPartyCookieSupport = true;\n  // brave\n  if (navigator.brave) {\n    thirdPartyCookieSupport = false;\n  }\n  // All webkit & gecko engine instances use itp (intelligent tracking prevention -\n  // https://webkit.org/tracking-prevention/#intelligent-tracking-prevention-itp)\n  if (browserInfo.engine.name === Bowser.ENGINE_MAP.WebKit || browserInfo.engine.name === Bowser.ENGINE_MAP.Gecko) {\n    thirdPartyCookieSupport = false;\n  }\n  return thirdPartyCookieSupport;\n}\nexport var log = loglevel.getLogger('broadcast-channel');\nlog.setLevel('error');\nexport var setLogLevel = function setLogLevel(level) {\n  log.setLevel(level);\n};","map":{"version":3,"names":["Bowser","loglevel","isPromise","obj","then","PROMISE_RESOLVED_FALSE","Promise","resolve","PROMISE_RESOLVED_TRUE","PROMISE_RESOLVED_VOID","sleep","time","resolveWith","res","setTimeout","randomInt","min","max","Math","floor","random","randomToken","toString","substring","lastMs","additional","microSeconds","ms","Date","getTime","are3PCSupported","navigator","browserInfo","parse","userAgent","log","info","JSON","stringify","thirdPartyCookieSupport","brave","engine","name","ENGINE_MAP","WebKit","Gecko","getLogger","setLevel","setLogLevel","level"],"sources":["/Users/wuhuan/gif-portal-starter/node_modules/@toruslabs/broadcast-channel/dist/esbrowser/util.js"],"sourcesContent":["import Bowser from 'bowser';\nimport loglevel from 'loglevel';\n\n/**\n * returns true if the given object is a promise\n */\nexport function isPromise(obj) {\n  if (obj && typeof obj.then === 'function') {\n    return true;\n  } else {\n    return false;\n  }\n}\nexport var PROMISE_RESOLVED_FALSE = Promise.resolve(false);\nexport var PROMISE_RESOLVED_TRUE = Promise.resolve(true);\nexport var PROMISE_RESOLVED_VOID = Promise.resolve();\nexport function sleep(time, resolveWith) {\n  if (!time) time = 0;\n  return new Promise(function (res) {\n    return setTimeout(function () {\n      return res(resolveWith);\n    }, time);\n  });\n}\nexport function randomInt(min, max) {\n  return Math.floor(Math.random() * (max - min + 1) + min);\n}\n\n/**\n * https://stackoverflow.com/a/8084248\n */\nexport function randomToken() {\n  return Math.random().toString(36).substring(2);\n}\nvar lastMs = 0;\nvar additional = 0;\n\n/**\n * returns the current time in micro-seconds,\n * WARNING: This is a pseudo-function\n * Performance.now is not reliable in webworkers, so we just make sure to never return the same time.\n * This is enough in browsers, and this function will not be used in nodejs.\n * The main reason for this hack is to ensure that BroadcastChannel behaves equal to production when it is used in fast-running unit tests.\n */\nexport function microSeconds() {\n  var ms = new Date().getTime();\n  if (ms === lastMs) {\n    additional++;\n    return ms * 1000 + additional;\n  } else {\n    lastMs = ms;\n    additional = 0;\n    return ms * 1000;\n  }\n}\nexport function are3PCSupported() {\n  if (typeof navigator === 'undefined') return false;\n  var browserInfo = Bowser.parse(navigator.userAgent);\n  log.info(JSON.stringify(browserInfo), 'current browser info');\n  var thirdPartyCookieSupport = true;\n  // brave\n  if (navigator.brave) {\n    thirdPartyCookieSupport = false;\n  }\n  // All webkit & gecko engine instances use itp (intelligent tracking prevention -\n  // https://webkit.org/tracking-prevention/#intelligent-tracking-prevention-itp)\n  if (browserInfo.engine.name === Bowser.ENGINE_MAP.WebKit || browserInfo.engine.name === Bowser.ENGINE_MAP.Gecko) {\n    thirdPartyCookieSupport = false;\n  }\n  return thirdPartyCookieSupport;\n}\nexport var log = loglevel.getLogger('broadcast-channel');\nlog.setLevel('error');\nexport var setLogLevel = function setLogLevel(level) {\n  log.setLevel(level);\n};"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}