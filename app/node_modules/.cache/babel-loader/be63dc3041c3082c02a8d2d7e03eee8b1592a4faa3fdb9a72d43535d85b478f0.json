{"ast":null,"code":"var id = 0;\nvar subscribers = [];\n/**\n * log something\n * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n * @param message a clear message of the log associated to the type\n */\nexport var log = function (type, message, data) {\n  var obj = {\n    type: type,\n    id: String(++id),\n    date: new Date()\n  };\n  if (message) obj.message = message;\n  if (data) obj.data = data;\n  dispatch(obj);\n};\n/**\n * listen to logs.\n * @param cb that is called for each future log() with the Log object\n * @return a function that can be called to unsubscribe the listener\n */\nexport var listen = function (cb) {\n  subscribers.push(cb);\n  return function () {\n    var i = subscribers.indexOf(cb);\n    if (i !== -1) {\n      // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n      subscribers[i] = subscribers[subscribers.length - 1];\n      subscribers.pop();\n    }\n  };\n};\nfunction dispatch(log) {\n  for (var i = 0; i < subscribers.length; i++) {\n    try {\n      subscribers[i](log);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\nif (typeof window !== \"undefined\") {\n  window.__ledgerLogsListen = listen;\n}","map":{"version":3,"names":["id","subscribers","log","type","message","data","obj","String","date","Date","dispatch","listen","cb","push","i","indexOf","length","pop","e","console","error","window","__ledgerLogsListen"],"sources":["/Users/wuhuan/gif-portal-starter/node_modules/@ledgerhq/logs/src/index.ts"],"sourcesContent":["/**\n * A Log object\n */\nexport interface Log {\n  type: string;\n  message?: string;\n  data?: any;\n  // unique amount all logs\n  id: string;\n  // date of the log\n  date: Date;\n}\nexport type Unsubscribe = () => void;\nexport type Subscriber = (arg0: Log) => void;\nlet id = 0;\nconst subscribers: Subscriber[] = [];\n\n/**\n * log something\n * @param type a namespaced identifier of the log (it is not a level like \"debug\", \"error\" but more like \"apdu-in\", \"apdu-out\", etc...)\n * @param message a clear message of the log associated to the type\n */\nexport const log = (type: string, message?: string, data?: any) => {\n  const obj: Log = {\n    type,\n    id: String(++id),\n    date: new Date(),\n  };\n  if (message) obj.message = message;\n  if (data) obj.data = data;\n  dispatch(obj);\n};\n\n/**\n * listen to logs.\n * @param cb that is called for each future log() with the Log object\n * @return a function that can be called to unsubscribe the listener\n */\nexport const listen = (cb: Subscriber): Unsubscribe => {\n  subscribers.push(cb);\n  return () => {\n    const i = subscribers.indexOf(cb);\n\n    if (i !== -1) {\n      // equivalent of subscribers.splice(i, 1) // https://twitter.com/Rich_Harris/status/1125850391155965952\n      subscribers[i] = subscribers[subscribers.length - 1];\n      subscribers.pop();\n    }\n  };\n};\n\nfunction dispatch(log: Log) {\n  for (let i = 0; i < subscribers.length; i++) {\n    try {\n      subscribers[i](log);\n    } catch (e) {\n      console.error(e);\n    }\n  }\n}\n\n// for debug purpose\n\ndeclare global {\n  interface Window {\n    __ledgerLogsListen: any;\n  }\n}\n\nif (typeof window !== \"undefined\") {\n  window.__ledgerLogsListen = listen;\n}\n"],"mappings":"AAcA,IAAIA,EAAE,GAAG,CAAC;AACV,IAAMC,WAAW,GAAiB,EAAE;AAEpC;;;;;AAKA,OAAO,IAAMC,GAAG,GAAG,SAAAA,CAACC,IAAY,EAAEC,OAAgB,EAAEC,IAAU;EAC5D,IAAMC,GAAG,GAAQ;IACfH,IAAI,EAAAA,IAAA;IACJH,EAAE,EAAEO,MAAM,CAAC,EAAEP,EAAE,CAAC;IAChBQ,IAAI,EAAE,IAAIC,IAAI;GACf;EACD,IAAIL,OAAO,EAAEE,GAAG,CAACF,OAAO,GAAGA,OAAO;EAClC,IAAIC,IAAI,EAAEC,GAAG,CAACD,IAAI,GAAGA,IAAI;EACzBK,QAAQ,CAACJ,GAAG,CAAC;AACf,CAAC;AAED;;;;;AAKA,OAAO,IAAMK,MAAM,GAAG,SAAAA,CAACC,EAAc;EACnCX,WAAW,CAACY,IAAI,CAACD,EAAE,CAAC;EACpB,OAAO;IACL,IAAME,CAAC,GAAGb,WAAW,CAACc,OAAO,CAACH,EAAE,CAAC;IAEjC,IAAIE,CAAC,KAAK,CAAC,CAAC,EAAE;MACZ;MACAb,WAAW,CAACa,CAAC,CAAC,GAAGb,WAAW,CAACA,WAAW,CAACe,MAAM,GAAG,CAAC,CAAC;MACpDf,WAAW,CAACgB,GAAG,EAAE;;EAErB,CAAC;AACH,CAAC;AAED,SAASP,QAAQA,CAACR,GAAQ;EACxB,KAAK,IAAIY,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGb,WAAW,CAACe,MAAM,EAAEF,CAAC,EAAE,EAAE;IAC3C,IAAI;MACFb,WAAW,CAACa,CAAC,CAAC,CAACZ,GAAG,CAAC;KACpB,CAAC,OAAOgB,CAAC,EAAE;MACVC,OAAO,CAACC,KAAK,CAACF,CAAC,CAAC;;;AAGtB;AAUA,IAAI,OAAOG,MAAM,KAAK,WAAW,EAAE;EACjCA,MAAM,CAACC,kBAAkB,GAAGX,MAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}